[2025-09-17 22:31:07,161][__main__][INFO] - üöÄ Starting Hydra-powered hole optimization
[2025-09-17 22:31:07,161][__main__][INFO] - üìÅ Working directory: /Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research
[2025-09-17 22:31:07,163][__main__][INFO] - ‚öôÔ∏è Configuration:
optimizer_type: differentiable
differentiable:
  learning_rate: 0.01
  max_iterations: 1000
  convergence_threshold: 1.0e-06
  temperature: 0.1
  temperature_schedule: constant
  hidden_dims:
  - 64
  - 32
  activation: relu
  l2_reg: 0.0001
  dropout_rate: 0.1
  vocab_angle_samples: 20
  vocab_hole_samples: 100
  truss_angle_samples: 20
  truss_hole_samples: 50
  truss_length_min: 3.0
  truss_length_max: 15.0
random_seed: 42
verbose: true
use_initial_layout: false
create_plots: true
constraints:
  vertical_length: 20.0
  handle_length: 38.0
  forearm_length: 17.0
  vertical_pivot_length: 19.0
  forearm_pivot_length: 19.0
  min_hole_distance: 2.0
  hole_margin: 0.5
  alpha_min: 85.0
  alpha_max: 115.0
  beta_min: 95.0
  beta_max: 140.0
  gamma_min: -9.0
  gamma_max: 9.0
  require_alpha_beta_sum_ge_180: true
objectives:
  vocabulary_weight: 1.0
  truss_complexity_weight: 0.5
  manufacturability_weight: 0.1
  robustness_weight: 0.1
  max_unique_trusses: 15
  min_vocabulary_size: 50
  length_tolerance: 0.25
  angle_tolerance: 1.0
cross_validation_folds: 5
test_split: 0.2

[2025-09-17 22:31:07,163][__main__][INFO] - üîß Using optimizer: differentiable
[2025-09-17 22:31:07,192][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/Users/riccardoconci/miniforge3/envs/OPMO2/lib/python3.12/site-packages/jaxlib/../../../libtpu.so' (no such file), '/Users/riccardoconci/miniforge3/envs/OPMO2/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
[2025-09-17 22:31:07,432][root][WARNING] - wandb not available, disabling wandb logging
[2025-09-17 22:31:07,766][__main__][INFO] - üéØ Running optimization...
[2025-09-17 22:31:08,962][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üöÄ Starting optimization with 38 parameters
[2025-09-17 22:31:08,963][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìä Max holes: Handle=19, Vertical=10, Forearm=9
[2025-09-17 22:31:08,966][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - best params raw: [0.1302882  0.18439665 0.14344254 0.20157045 0.21664487 0.2806092
 0.34295806 0.34858936 0.44671643 0.49754125 0.5238557  0.5692074
 0.698915   0.6885556  0.74280447 0.75218916 0.76285267 0.8780193
 0.87797856 0.12161533 0.21825208 0.22069408 0.3479767  0.44560048
 0.45808896 0.541682   0.69913805 0.8095134  0.8111305  0.08590527
 0.13162556 0.21824808 0.41549993 0.4807753  0.6101516  0.7083607
 0.7562549  0.90300953]
[2025-09-17 22:31:09,020][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîÑ Iteration 1/1000
[2025-09-17 22:31:09,020][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìä Computing objective function...
[2025-09-17 22:31:09,020][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üéØ Starting objective function computation...
[2025-09-17 22:31:09,033][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîÑ Converting parameters to hole layout...
[2025-09-17 22:31:09,822][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìà Computing vocabulary score...
[2025-09-17 22:31:09,823][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîç Computing vocabulary score...
[2025-09-17 22:31:09,964][__main__][ERROR] - ‚ùå Optimization failed: Non-hashable static arguments are not supported. An error occurred while trying to hash an object of type <class 'hole_optimization.config.DifferentiableConfig'>, DifferentiableConfig(learning_rate=0.01, max_iterations=1000, convergence_threshold=1e-06, temperature=0.1, temperature_schedule='constant', hidden_dims=[64, 32], activation='relu', l2_reg=0.0001, dropout_rate=0.1, vocab_angle_samples=20, vocab_hole_samples=100, truss_angle_samples=20, truss_hole_samples=50, truss_length_min=3.0, truss_length_max=15.0). The error was:
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/main.py", line 302, in <module>
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/main.py", line 94, in decorated_main
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/_internal/utils.py", line 457, in _run_app
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/_internal/hydra.py", line 119, in run
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/hydra/core/utils.py", line 186, in run_job
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/main.py", line 47, in main
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/main.py", line 95, in run_single_optimization_mode
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/optimizers/differentiable.py", line 106, in optimize
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/optimizers/differentiable.py", line 291, in _objective_function_with_info
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/api.py", line 481, in value_and_grad_f
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/api.py", line 2147, in _vjp
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/interpreters/ad.py", line 311, in vjp
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/interpreters/ad.py", line 283, in linearize
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/interpreters/ad.py", line 250, in direct_linearize
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/linear_util.py", line 212, in call_wrapped
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/api_util.py", line 106, in flatten_fun_nokwargs2
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/api_util.py", line 288, in _argnums_partial
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/linear_util.py", line 397, in _get_result_paths_thunk
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/optimizers/differentiable.py", line 254, in objective_with_info
  File "/Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research/hole_optimization/optimizers/differentiable.py", line 418, in _differentiable_vocabulary_score
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/traceback_util.py", line 180, in reraise_with_filtered_traceback
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/pjit.py", line 260, in cache_miss
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/pjit.py", line 137, in _python_pjit_helper
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/pjit.py", line 629, in _infer_params
  File "/Users/riccardoconci/miniforge3/envs/opmo2/lib/python3.12/site-packages/jax/_src/pjit.py", line 650, in _infer_params_internal
  File "<string>", line 3, in __hash__
TypeError: unhashable type: 'list'

