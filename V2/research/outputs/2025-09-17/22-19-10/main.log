[2025-09-17 22:19:10,792][__main__][INFO] - ğŸš€ Starting Hydra-powered hole optimization
[2025-09-17 22:19:10,792][__main__][INFO] - ğŸ“ Working directory: /Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research
[2025-09-17 22:19:10,793][__main__][INFO] - âš™ï¸ Configuration:
optimizer_type: differentiable
differentiable:
  learning_rate: 0.01
  max_iterations: 1000
  convergence_threshold: 1.0e-06
  temperature: 0.1
  temperature_schedule: constant
  hidden_dims:
  - 64
  - 32
  activation: relu
  l2_reg: 0.0001
  dropout_rate: 0.1
  vocab_angle_samples: 20
  vocab_hole_samples: 50
  truss_angle_samples: 20
  truss_hole_samples: 50
  truss_length_min: 3.0
  truss_length_max: 15.0
random_seed: 42
verbose: true
use_initial_layout: false
create_plots: true
constraints:
  vertical_length: 20.0
  handle_length: 38.0
  forearm_length: 17.0
  vertical_pivot_length: 19.0
  forearm_pivot_length: 19.0
  min_hole_distance: 2.0
  hole_margin: 0.5
  alpha_min: 85.0
  alpha_max: 115.0
  beta_min: 95.0
  beta_max: 140.0
  gamma_min: -9.0
  gamma_max: 9.0
  require_alpha_beta_sum_ge_180: true
objectives:
  vocabulary_weight: 1.0
  truss_complexity_weight: 0.5
  manufacturability_weight: 0.1
  robustness_weight: 0.1
  max_unique_trusses: 15
  min_vocabulary_size: 50
  length_tolerance: 0.25
  angle_tolerance: 1.0
cross_validation_folds: 5
test_split: 0.2

[2025-09-17 22:19:10,794][__main__][INFO] - ğŸ”§ Using optimizer: differentiable
[2025-09-17 22:19:10,869][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/Users/riccardoconci/miniforge3/envs/OPMO2/lib/python3.12/site-packages/jaxlib/../../../libtpu.so' (no such file), '/Users/riccardoconci/miniforge3/envs/OPMO2/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
[2025-09-17 22:19:11,406][root][WARNING] - wandb not available, disabling wandb logging
[2025-09-17 22:19:11,780][__main__][INFO] - ğŸ¯ Running optimization...
[2025-09-17 22:19:12,448][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸš€ Starting optimization with 38 parameters
[2025-09-17 22:19:12,448][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ“Š Max holes: Handle=19, Vertical=10, Forearm=9
[2025-09-17 22:19:12,449][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - best params raw: [0.1302882  0.18439665 0.14344254 0.20157045 0.21664487 0.2806092
 0.34295806 0.34858936 0.44671643 0.49754125 0.5238557  0.5692074
 0.698915   0.6885556  0.74280447 0.75218916 0.76285267 0.8780193
 0.87797856 0.12161533 0.21825208 0.22069408 0.3479767  0.44560048
 0.45808896 0.541682   0.69913805 0.8095134  0.8111305  0.08590527
 0.13162556 0.21824808 0.41549993 0.4807753  0.6101516  0.7083607
 0.7562549  0.90300953]
[2025-09-17 22:19:12,474][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ”„ Iteration 1/1000
[2025-09-17 22:19:12,475][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ“Š Computing objective function...
[2025-09-17 22:19:12,475][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ¯ Starting objective function computation...
[2025-09-17 22:19:12,478][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ”„ Converting parameters to hole layout...
[2025-09-17 22:19:12,584][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ“ˆ Computing vocabulary score...
[2025-09-17 22:19:12,584][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Computing vocabulary score...
[2025-09-17 22:19:12,605][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ“ Sampling 20 Î±, 20 Î², 10 Î³ angles
[2025-09-17 22:19:12,605][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ¯ Total combinations to test: 4000
[2025-09-17 22:19:12,678][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=85.0Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:19:22,932][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=85.0Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:19:27,307][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=86.6Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:19:31,531][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=86.6Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:19:35,852][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=88.2Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:19:40,179][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=88.2Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:19:45,012][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=89.7Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:19:48,936][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=89.7Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:19:53,652][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=91.3Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:19:57,697][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=91.3Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:02,942][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=92.9Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:20:06,939][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=92.9Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:11,520][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=94.5Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:20:17,242][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=94.5Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:21,240][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=96.1Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:20:25,163][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=96.1Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:31,209][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=97.6Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:20:35,293][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=97.6Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:39,433][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=99.2Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:20:43,571][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=99.2Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:47,752][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=100.8Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:20:54,300][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=100.8Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:20:58,285][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=102.4Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:21:02,415][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=102.4Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:21:06,620][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=103.9Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:21:11,117][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=103.9Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:21:20,845][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=105.5Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:21:25,402][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=105.5Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:21:29,860][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=107.1Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:21:34,067][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=107.1Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:21:38,240][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=108.7Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:21:42,448][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=108.7Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:21:50,801][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=110.3Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:21:54,815][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=110.3Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:21:58,822][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=111.8Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:22:02,908][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=111.8Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:22:06,838][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=113.4Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:22:11,211][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=113.4Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:22:15,145][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=115.0Â°, Î²=95.0Â°, Î³=-9.0Â°
[2025-09-17 22:22:19,222][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ğŸ” Testing geometry: Î±=115.0Â°, Î²=118.7Â°, Î³=-9.0Â°
[2025-09-17 22:22:43,054][__main__][ERROR] - âŒ Optimization failed: Abstract tracer value encountered where concrete value is expected: traced array with shape float32[]
The problem arose with the `float` function. If trying to convert the data type of a value, try using `x.astype(float)` or `jnp.array(x, float)` instead.

See https://docs.jax.dev/en/latest/errors.html#jax.errors.ConcretizationTypeError
