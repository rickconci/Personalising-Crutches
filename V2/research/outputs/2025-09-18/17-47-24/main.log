[2025-09-18 17:47:24,509][__main__][INFO] - üöÄ Starting Hydra-powered hole optimization
[2025-09-18 17:47:24,510][__main__][INFO] - üìÅ Working directory: /Users/riccardoconci/Local_documents/Personalising-Crutches/V2/research
[2025-09-18 17:47:24,511][__main__][INFO] - ‚öôÔ∏è Configuration:
optimizer_type: differentiable
differentiable:
  learning_rate: 0.01
  max_iterations: 1000
  convergence_threshold: 1.0e-06
  temperature: 0.1
  temperature_schedule: constant
  hidden_dims:
  - 64
  - 32
  activation: relu
  l2_reg: 0.0001
  dropout_rate: 0.1
  vocab_angle_samples: 20
  vocab_hole_samples: 100
  truss_angle_samples: 20
  truss_hole_samples: 50
  truss_length_min: 3.0
  truss_length_max: 15.0
random_seed: 42
verbose: true
use_initial_layout: false
create_plots: true
constraints:
  vertical_length: 20.0
  handle_length: 38.0
  forearm_length: 17.0
  vertical_pivot_length: 19.0
  forearm_pivot_length: 19.0
  min_hole_distance: 2.0
  hole_margin: 0.5
  alpha_min: 85.0
  alpha_max: 115.0
  beta_min: 95.0
  beta_max: 140.0
  gamma_min: -9.0
  gamma_max: 9.0
  require_alpha_beta_sum_ge_180: true
objectives:
  vocabulary_weight: 1.0
  truss_complexity_weight: 0.5
  manufacturability_weight: 0.1
  robustness_weight: 0.1
  max_unique_trusses: 6
  min_vocabulary_size: 50
  length_tolerance: 0.25
  angle_tolerance: 1.0
cross_validation_folds: 5
test_split: 0.2

[2025-09-18 17:47:24,512][__main__][INFO] - üîß Using optimizer: differentiable
[2025-09-18 17:47:24,525][jax._src.xla_bridge][INFO] - Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: dlopen(libtpu.so, 0x0001): tried: 'libtpu.so' (no such file), '/System/Volumes/Preboot/Cryptexes/OSlibtpu.so' (no such file), '/Users/riccardoconci/miniforge3/envs/OPMO2/lib/python3.12/site-packages/jaxlib/../../../libtpu.so' (no such file), '/Users/riccardoconci/miniforge3/envs/OPMO2/bin/../lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache), 'libtpu.so' (no such file), '/usr/local/lib/libtpu.so' (no such file), '/usr/lib/libtpu.so' (no such file, not in dyld cache)
[2025-09-18 17:47:24,568][root][WARNING] - wandb not available, disabling wandb logging
[2025-09-18 17:47:24,881][__main__][INFO] - üéØ Running optimization...
[2025-09-18 17:47:25,466][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üöÄ Starting optimization with 38 parameters
[2025-09-18 17:47:25,466][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìä Max holes: Handle=19, Vertical=10, Forearm=9
[2025-09-18 17:47:25,467][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - best params raw: [0.1302882  0.18439665 0.14344254 0.20157045 0.21664487 0.2806092
 0.34295806 0.34858936 0.44671643 0.49754125 0.5238557  0.5692074
 0.698915   0.6885556  0.74280447 0.75218916 0.76285267 0.8780193
 0.87797856 0.12161533 0.21825208 0.22069408 0.3479767  0.44560048
 0.45808896 0.541682   0.69913805 0.8095134  0.8111305  0.08590527
 0.13162556 0.21824808 0.41549993 0.4807753  0.6101516  0.7083607
 0.7562549  0.90300953]
[2025-09-18 17:47:25,485][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîÑ Iteration 1/1000
[2025-09-18 17:47:25,485][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìä Computing objective function...
[2025-09-18 17:47:25,485][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üéØ Starting objective function computation...
[2025-09-18 17:47:25,487][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîÑ Converting parameters to hole layout...
[2025-09-18 17:47:25,589][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìà Computing vocabulary score...
[2025-09-18 17:47:25,590][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîç Computing vocabulary score...
[2025-09-18 17:47:26,977][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîß Computing truss complexity...
[2025-09-18 17:47:26,977][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üîß Computing truss complexity...
[2025-09-18 17:47:26,977][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üìä Hole counts: Handle=19, Vertical=10, Forearm=9
[2025-09-18 17:47:26,978][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - üéØ Sampling 20 Œ± √ó 10 Œ≥ √ó 50 hole combinations = 10000 total
[2025-09-18 17:52:24,551][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - ‚ö° Applying gradient updates...
[2025-09-18 17:52:25,095][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] - --- Iteration 0 ---
[2025-09-18 17:52:25,096][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] -   Loss: 4.6132 (Improvement: 0.000000) | Best: 4.6132
[2025-09-18 17:52:25,096][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] -   -> Vocab Score: 0.00 | Truss Complexity: 9.22 (L2: 0.0011)
[2025-09-18 17:52:25,099][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] -   -> Geometry Realizability: Mean=0.000, Max=0.000
[2025-09-18 17:52:25,099][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] -   -> Truss Stats: Estimated Unique Trusses=9.22
[2025-09-18 17:52:25,100][hole_optimization.optimizers.differentiable.DifferentiableOptimizer][INFO] -   -> Gradients Norm: 7.0344 | Params Norm: 3.3259
[2025-09-18 17:52:25,124][optimizer.differentiable_1758232044][INFO] - Iter    0 | Obj: 4.613240 | Œî: 0.00e+00 | Vocab: 0.00 | Truss: 9.22
[2025-09-18 17:52:25,250][optimizer.differentiable_1758232044][INFO] - Iter 0 | Grad norm: 7.034361, Max: 3.155217
[2025-09-18 17:52:25,264][__main__][ERROR] - ‚ùå Optimization failed: Object of type ArrayImpl is not JSON serializable
